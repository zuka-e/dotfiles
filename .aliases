#!/usr/bin/env bash

# Derivative of 'ls'
if [[ "$(uname)" == "Linux" ]]; then
  v="--sort=version" # (-v) Natural sort of (version) numbers within text
  A="--almost-all" # (-A) Show 'dotfiles' without . and ..
  F="--classify" # (-F) Append file-type indicator
  alias ls="ls $v $A --color=auto"
  alias lf="ls $F"
  strftime='--time-style="+%Y-%m-%d %H:%M:%S"' # Format time
  alias ll="ls -l --all --human-readable $strftime" # (-lah) Print sizes with unit
  alias llf="ll --inode --size" # (-is) Show index number, allocated size
  alias llat="llt --sort=time --time=atime" # (-tu) Sort by Access time
  alias llmt="llt --sort=time" # (-t) Sort by Modification time
  alias llct="llt --sort=time --time=ctime" # Sort by Change-status time
  unset v A F strftime
elif [[ "$(uname)" == "Darwin" ]]; then
  alias ls="ls -AG" # Use'LSCOLORS' for Mac
  alias lf="ls -F"
  alias ll="ls -lahT" # -T: Display complete time
  alias llf="ll -is" # Show index number, allocated size
  alias llat="ll -tu" # Sort by Access time
  alias llmt="ll -t" # Sort by Modification time
  alias llct="ll -tc" # Sort by Change-status time
fi

# Judge if 'exa' exists
if type exa > /dev/null 2>&1; then
  ll="exa -alh --links --group --time-style=long-iso --git"
  alias ll="$ll"
  alias llf="$ll --inode --blocks"
  alias llat="$ll --time=accessed --sort=accessed"
  alias llmt="$ll --time=modified --sort=modified"
  alias llct="$ll --time=changed --sort=changed"
  unset ll
fi

if type fd > /dev/null 2>&1; then
  # -I: Don't respect ignore files
  # -H: Include hidden files and directories
  alias fd="fd --no-ignore --hidden" # (-uu)
  # Equivalent to 'ls -1A', but the output is filepath
  alias pathls="fd --max-depth 1 '.'"
fi

if type rg > /dev/null 2>&1; then
  alias ripgrep="rg"
  # --no-ignore: Don't respect ignore files
  # -.: Include hidden files and directories
  # -S: Case-insensitive if the pattern is all lowercase
  # -H: Display the filepath even if only one file is searched
  alias rg="rg --no-ignore --hidden --smart-case --with-filename"
  alias frg="rg --fixed-strings"
fi

# When 'cd' run, 'ls' run too
function cdls() { \cd "$@" && ls; }
alias cd="cdls"

# When 'mkdir' run, 'cd $_' run too
function mkdircd() { \mkdir -p "$@" && cd "$_"; }
alias mkdir="mkdircd"

# Output line number & Mark up the matching text
alias grep="grep -n --color=auto"
alias egrep="egrep -n --color=auto"
alias fgrep="fgrep -n --color=auto"

# Use extended regular expression
alias esed="sed -E"

# Opts: Interactive, Preserve-attributes, Recursive, Verbose
alias cp="cp -iprv"
alias scp="echo Deprecated! Use \'rsync\' etc instead.; #"
alias mv="mv -iv"
alias rm="rm -irv"

#------------------------------------------------
# Rsync
#------------------------------------------------
# -a, --archive          archive mode; same as -rlptgoD (no -H)
  # -r, --recursive        recurse into directories
  # -l, --links            copy symlinks as symlinks
  # -p, --perms            preserve permissions
  # -t, --times            preserve times
  # -g, --group            preserve group
  #     --devices          preserve device files (super-user only)
  #     --specials         preserve special files
  # -o, --owner            preserve owner (super-user only)
  # -D                     same as --devices --specials
  # -H, --hard-links       preserve hard links
# -u, --update           skip files that are newer on the receiver
# -v, --verbose          increase verbosity
alias rsync="rsync --archive --update --verbose"

# Short names
alias sail='bash vendor/bin/sail'

# Enable alias
alias sudo="sudo "
alias xargs="xargs "

# Read stdin line by line instead of spaces
# this is useful when searching space separated files
# ex. ls | readline | xargs grep "foo"
alias readline='while read line; do echo \""$line"\"; done'

# Reload the current shell
alias reload="exec "${SHELL}" -l"

# Show $PATH by line
alias path='echo $PATH | tr ":" "\n"'
